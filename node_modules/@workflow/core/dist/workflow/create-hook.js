import { WORKFLOW_CREATE_HOOK } from '../symbols.js';
import { getWorkflowMetadata } from './get-workflow-metadata.js';
export function createHook(options) {
    // Inside the workflow VM, the hook function is stored in the globalThis object behind a symbol
    const createHookFn = globalThis[WORKFLOW_CREATE_HOOK];
    if (!createHookFn) {
        throw new Error('`createHook()` can only be called inside a workflow function');
    }
    return createHookFn(options);
}
export function createWebhook(options) {
    const { respondWith, ...rest } = options ?? {};
    let metadata;
    if (typeof respondWith !== 'undefined') {
        metadata = { respondWith };
    }
    const hook = createHook({ ...rest, metadata });
    const { url } = getWorkflowMetadata();
    hook.url = `${url}/.well-known/workflow/v1/webhook/${encodeURIComponent(hook.token)}`;
    return hook;
}
//# sourceMappingURL=create-hook.js.map